import{_ as L,m as U,e as u,s as q,o as _,c as M,f as b,g as e,w as n,v as d,p as f,i as r,F as D,n as I,y as h}from"./index-b737c2d7.js";const B={name:"menu",data(){return{queryForm:{menuState:1},menuList:[],columns:[{label:"菜单名称",prop:"menuName",width:150},{label:"图标",prop:"icon"},{label:"菜单类型",prop:"menuType",formatter(m,l,s){return{1:"菜单",2:"按钮"}[s]}},{label:"权限标识",prop:"menuCode"},{label:"路由地址",prop:"path"},{label:"组件路径",prop:"component"},{label:"菜单状态",prop:"menuState",width:90,formatter(m,l,s){return{1:"正常",2:"停用"}[s]}},{label:"创建时间",prop:"createTime",formatter(m,l,s){return U.formateDate(new Date(s))}}],showModal:!1,menuForm:{parentId:[null],menuType:1,menuState:1},action:"",rules:{menuName:[{required:!0,message:"请输入菜单名称",trigger:"blur"},{min:2,max:10,message:"长度在2~8个字符",trigger:"blur"}]}}},mounted(){this.getMenuList()},methods:{async getMenuList(){try{let m=await this.$api.getMenuList(this.queryForm);this.menuList=m}catch(m){throw new Error(m)}},handleReset(m){this.$refs[m].resetFields()},handleAdd(m,l){this.showModal=!0,this.action="add",m===2&&(this.menuForm.parentId=[...l.parentId,l._id].filter(s=>s))},handleEdit(m){this.showModal=!0,this.action="edit",this.$nextTick(()=>{Object.assign(this.menuForm,m)})},async handleDel(m){await this.$api.menuSubmit({_id:m,action:"delete"}),this.$message.success("删除成功"),this.getMenuList()},handleSubmit(){this.$refs.dialogForm.validate(async m=>{if(m){let{action:l,menuForm:s}=this,V={...s,action:l};await this.$api.menuSubmit(V),this.showModal=!1,this.$message.success("操作成功"),this.handleReset("dialogForm"),this.getMenuList()}})},handleClose(){this.showModal=!1,this.handleReset("dialogForm")}}},E={class:"menu-manage"},R={class:"query-form"},z={class:"base-table"},A={class:"action"},j=b("span",null,"不选，则直接创建一级菜单",-1),O={class:"dialog-footer"};function G(m,l,s,V,o,i){const c=u("el-input"),a=u("el-form-item"),w=u("el-option"),S=u("el-select"),p=u("el-button"),g=u("el-form"),v=u("el-table-column"),x=u("el-table"),T=u("el-cascader"),F=u("el-radio"),C=u("el-radio-group"),N=u("el-dialog"),y=q("has");return _(),M("div",E,[b("div",R,[e(g,{ref:"form",inline:!0,model:o.queryForm},{default:n(()=>[e(a,{label:"菜单名称",prop:"menuName"},{default:n(()=>[e(c,{modelValue:o.queryForm.menuName,"onUpdate:modelValue":l[0]||(l[0]=t=>o.queryForm.menuName=t),placeholder:"请输入菜单名称"},null,8,["modelValue"])]),_:1}),e(a,{label:"菜单状态",prop:"menuState"},{default:n(()=>[e(S,{modelValue:o.queryForm.menuState,"onUpdate:modelValue":l[1]||(l[1]=t=>o.queryForm.menuState=t)},{default:n(()=>[e(w,{value:1,label:"正常"}),e(w,{value:2,label:"停用"})]),_:1},8,["modelValue"])]),_:1}),e(a,null,{default:n(()=>[e(p,{type:"primary",onClick:i.getMenuList},{default:n(()=>[r("查询")]),_:1},8,["onClick"]),e(p,{onClick:l[2]||(l[2]=t=>i.handleReset("form"))},{default:n(()=>[r("重置")]),_:1})]),_:1})]),_:1},8,["model"])]),b("div",z,[b("div",A,[d((_(),f(p,{type:"primary",onClick:l[3]||(l[3]=t=>i.handleAdd(1))},{default:n(()=>[r("新增")]),_:1})),[[y,"menu-create"]])]),e(x,{data:o.menuList,"row-key":"_id","tree-props":{children:"children"}},{default:n(()=>[(_(!0),M(D,null,I(o.columns,t=>(_(),f(v,{key:t.prop,prop:t.prop,label:t.label,width:t.width,formatter:t.formatter},null,8,["prop","label","width","formatter"]))),128)),e(v,{fixed:"right",label:"操作",width:"180"},{default:n(t=>[d((_(),f(p,{type:"text",size:"small",onClick:k=>i.handleAdd(2,t.row)},{default:n(()=>[r("新增")]),_:2},1032,["onClick"])),[[y,"menu-create"]]),d((_(),f(p,{type:"text",size:"small",onClick:k=>i.handleEdit(t.row)},{default:n(()=>[r("编辑")]),_:2},1032,["onClick"])),[[y,"menu-edit"]]),d((_(),f(p,{type:"text",size:"small",onClick:k=>i.handleDel(t.row._id)},{default:n(()=>[r("删除")]),_:2},1032,["onClick"])),[[y,"menu-delete"]])]),_:1})]),_:1},8,["data"])]),e(N,{title:"新增菜单",modelValue:o.showModal,"onUpdate:modelValue":l[12]||(l[12]=t=>o.showModal=t)},{footer:n(()=>[b("span",O,[e(p,{onClick:i.handleClose},{default:n(()=>[r("取 消")]),_:1},8,["onClick"]),e(p,{type:"primary",onClick:i.handleSubmit},{default:n(()=>[r("确 定")]),_:1},8,["onClick"])])]),default:n(()=>[e(g,{ref:"dialogForm",model:o.menuForm,"label-width":"100px",rules:o.rules},{default:n(()=>[e(a,{label:"父级菜单",prop:"parentId"},{default:n(()=>[e(T,{modelValue:o.menuForm.parentId,"onUpdate:modelValue":l[4]||(l[4]=t=>o.menuForm.parentId=t),options:o.menuList,props:{checkStrictly:!0,value:"_id",label:"menuName"},placeholder:"请选择父级菜单",clearable:""},null,8,["modelValue","options"]),j]),_:1}),e(a,{label:"菜单类型",prop:"menuType"},{default:n(()=>[e(C,{modelValue:o.menuForm.menuType,"onUpdate:modelValue":l[5]||(l[5]=t=>o.menuForm.menuType=t)},{default:n(()=>[e(F,{label:1},{default:n(()=>[r("菜单")]),_:1}),e(F,{label:2},{default:n(()=>[r("按钮")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(a,{label:"菜单名称",prop:"menuName"},{default:n(()=>[e(c,{modelValue:o.menuForm.menuName,"onUpdate:modelValue":l[6]||(l[6]=t=>o.menuForm.menuName=t),placeholder:"请输入菜单名称"},null,8,["modelValue"])]),_:1}),d(e(a,{label:"菜单图标",prop:"icon"},{default:n(()=>[e(c,{modelValue:o.menuForm.icon,"onUpdate:modelValue":l[7]||(l[7]=t=>o.menuForm.icon=t),placeholder:"请输入图标"},null,8,["modelValue"])]),_:1},512),[[h,o.menuForm.menuType==1]]),d(e(a,{label:"路由地址",prop:"path"},{default:n(()=>[e(c,{modelValue:o.menuForm.path,"onUpdate:modelValue":l[8]||(l[8]=t=>o.menuForm.path=t),placeholder:"请输入路由地址"},null,8,["modelValue"])]),_:1},512),[[h,o.menuForm.menuType==1]]),d(e(a,{label:"权限标识",prop:"menuCode"},{default:n(()=>[e(c,{modelValue:o.menuForm.menuCode,"onUpdate:modelValue":l[9]||(l[9]=t=>o.menuForm.menuCode=t),placeholder:"请输入权限标识"},null,8,["modelValue"])]),_:1},512),[[h,o.menuForm.menuType==2]]),d(e(a,{label:"组件路径",prop:"component"},{default:n(()=>[e(c,{modelValue:o.menuForm.component,"onUpdate:modelValue":l[10]||(l[10]=t=>o.menuForm.component=t),placeholder:"请输入组件路径"},null,8,["modelValue"])]),_:1},512),[[h,o.menuForm.menuType==1]]),d(e(a,{label:"菜单状态",prop:"menuState"},{default:n(()=>[e(C,{modelValue:o.menuForm.menuState,"onUpdate:modelValue":l[11]||(l[11]=t=>o.menuForm.menuState=t)},{default:n(()=>[e(F,{label:1},{default:n(()=>[r("正常")]),_:1}),e(F,{label:2},{default:n(()=>[r("停用")]),_:1})]),_:1},8,["modelValue"])]),_:1},512),[[h,o.menuForm.menuType==1]])]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}const J=L(B,[["render",G]]);export{J as default};
